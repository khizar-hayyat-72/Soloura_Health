(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[332],{7793:(e,r,i)=>{"use strict";i.r(r),i.d(r,{default:()=>s});var a=i(37876),t=i(14232),o=i(14e3),l=i(49105),n=i(34855);function s(){let e=(0,o.useRouter)(),{user:r,isLoading:i}=(0,l.A)();return(0,t.useEffect)(()=>{i||(r?e.replace("/dashboard"):e.replace("/login"))},[r,i,e]),(0,a.jsxs)("div",{className:"min-h-screen flex flex-col items-center justify-center bg-background",children:[(0,a.jsx)(n.A,{className:"h-12 w-12 animate-spin text-primary"}),(0,a.jsx)("p",{className:"mt-4 text-lg text-muted-foreground",children:"Loading Soloura..."})]})}},16760:(e,r,i)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return i(7793)}])},34855:(e,r,i)=>{"use strict";i.d(r,{A:()=>a});let a=(0,i(38684).A)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},38684:(e,r,i)=>{"use strict";i.d(r,{A:()=>s});var a=i(14232);let t=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),o=function(){for(var e=arguments.length,r=Array(e),i=0;i<e;i++)r[i]=arguments[i];return r.filter((e,r,i)=>!!e&&""!==e.trim()&&i.indexOf(e)===r).join(" ").trim()};var l={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let n=(0,a.forwardRef)((e,r)=>{let{color:i="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:s,className:u="",children:d,iconNode:c,...m}=e;return(0,a.createElement)("svg",{ref:r,...l,width:t,height:t,stroke:i,strokeWidth:s?24*Number(n)/Number(t):n,className:o("lucide",u),...m},[...c.map(e=>{let[r,i]=e;return(0,a.createElement)(r,i)}),...Array.isArray(d)?d:[d]])}),s=(e,r)=>{let i=(0,a.forwardRef)((i,l)=>{let{className:s,...u}=i;return(0,a.createElement)(n,{ref:l,iconNode:r,className:o("lucide-".concat(t(e)),s),...u})});return i.displayName="".concat(e),i}},49105:(e,r,i)=>{"use strict";i.d(r,{A:()=>m});var a=i(14232),t=i(14e3),o=i(29917),l=i(82964),n=i(52007);let s="users";async function u(e,r,i){if(!i)throw Error("Password is required for signup.");try{let a=(await (0,o.eJ)(n.j,e,i)).user;await (0,o.gA)(a),console.log("[Auth] Verification email sent.");let t={id:a.uid,email:a.email||e,name:r,emailVerified:a.emailVerified};return await (0,l.BN)((0,l.H9)(n.db,s,a.uid),t),console.log("[Auth] User signed up and profile created in Firestore:",t),t}catch(e){throw console.error("[Auth] Error during signup:",e.message),e}}async function d(e,r){if(!r)throw Error("Password is required for login.");try{let i=(await (0,o.x9)(n.j,e,r)).user,a=(0,l.H9)(n.db,s,i.uid),t=await (0,l.x7)(a);if(t.exists())t.data().emailVerified!==i.emailVerified&&await (0,l.mZ)(a,{emailVerified:i.emailVerified});else{console.warn("[Auth] User profile not found in Firestore during login. Creating a basic one.");let r={id:i.uid,email:i.email||e,name:i.displayName||e.split("@")[0],emailVerified:i.emailVerified};await (0,l.BN)(a,r)}return console.log("[Auth] User authentication successful via signInWithEmailAndPassword."),i}catch(e){throw console.error("[Auth] Error during login:",e.message),e}}async function c(){try{await (0,o.CI)(n.j),console.log("[Auth] User signed out.")}catch(e){throw console.error("[Auth] Error during sign out:",e.message),e}}function m(){let[e,r]=(0,a.useState)(null),[i,m]=(0,a.useState)(!0),f=(0,t.useRouter)();(0,a.useEffect)(()=>{var e;let i=(e=e=>{r(e),m(!1),e||["/login","/signup"].includes(window.location.pathname)},(0,o.hg)(n.j,async r=>{if(r){let a=(0,l.H9)(n.db,s,r.uid),t=await (0,l.x7)(a);if(t.exists()){let i=t.data();i.emailVerified!==r.emailVerified&&await (0,l.mZ)(a,{emailVerified:r.emailVerified}),e({...i,id:r.uid,email:r.email||i.email,emailVerified:r.emailVerified})}else{var i;console.warn("[Auth] User profile not found for UID: ".concat(r.uid," during onAuthStateChanged. Creating a basic profile."));let a={id:r.uid,email:r.email||"",name:r.displayName||(null==(i=r.email)?void 0:i.split("@")[0])||"User",emailVerified:r.emailVerified};try{await (0,l.BN)((0,l.H9)(n.db,s,r.uid),a),e(a)}catch(i){console.error("[Auth] Failed to create fallback user profile in Firestore:",i),e({id:r.uid,email:r.email||"",name:r.displayName||"User",emailVerified:r.emailVerified})}}}else e(null)}));return()=>i()},[]);let h=(0,a.useCallback)(async(e,r)=>{m(!0);try{let i=await d(e,r);return i&&f.push("/dashboard"),i}catch(e){throw console.error("[AuthHook] Login failed:",e),m(!1),e}},[f]);return{user:e,isLoading:i,login:h,signup:(0,a.useCallback)(async(e,r,i)=>{m(!0);try{let a=await u(e,r,i);return f.push("/login"),a}catch(e){throw console.error("[AuthHook] Signup failed:",e),m(!1),e}},[f]),logout:(0,a.useCallback)(async()=>{m(!0);try{await c(),f.push("/login")}catch(e){console.error("[AuthHook] Logout failed:",e),m(!1)}},[f])}}},52007:(e,r,i)=>{"use strict";let a;i.d(r,{db:()=>u,j:()=>s});var t=i(16042),o=i(29917),l=i(82964);let n={apiKey:"AIzaSyBiidZpnKIjM59jXZoCgEWvylA1CQjc2PM",authDomain:"soloura-health.firebaseapp.com",projectId:"soloura-health",storageBucket:"soloura-health.firebasestorage.app",messagingSenderId:"179780492964",appId:"1:179780492964:web:665c44b3a7fe5906e11031",measurementId:"G-L6B1SZS5C4"};n.apiKey&&n.authDomain&&n.projectId||console.error("Firebase configuration is missing or incomplete. Please check your environment variables (e.g., .env.local for development or hosting provider settings for production)."),a=(0,t.Dk)().length?(0,t.Sx)():(0,t.Wp)(n);let s=(0,o.xI)(a),u=(0,l.aU)(a)}},e=>{var r=r=>e(e.s=r);e.O(0,[671,389,679,636,593,792],()=>r(16760)),_N_E=e.O()}]);